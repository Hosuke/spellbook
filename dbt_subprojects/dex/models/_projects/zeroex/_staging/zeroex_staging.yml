version: 2

models:
  - name: zeroex_all_logs
    meta:
      blockchain: ethereum, arbitrum, optimism, polygon, base, avalanche_c, bnb, scroll, linea, fantom, blast, mantle, worldchain, berachain, celo
      project: zeroex
      contributors: hosuke
    config:
      tags: ['staging', '0x', 'logs']
    description: >
      Materialized table of filtered 0x Protocol logs.
      This table is used as an intermediate step for performance optimization
      in the zeroex_v2_trades processing pipeline.
    data_test:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - blockchain
            - tx_hash
            - index
    columns:
      - name: blockchain
        description: "Blockchain name (e.g., ethereum, arbitrum, etc.)"
      - name: tx_hash
        description: "Transaction hash"
      - name: block_time
        description: "Block timestamp"
      - name: block_number
        description: "Block number"
      - name: index
        description: "Log index in the transaction"
      - name: contract_address
        description: "Contract address that emitted the log"
      - name: topic0
        description: "First log topic (usually the event signature)"
      - name: topic1
        description: "Second log topic"
      - name: topic2
        description: "Third log topic"
      - name: method_id
        description: "Method ID extracted from the input data"
      - name: tag
        description: "0x Protocol tag"
      - name: settler_address
        description: "Address of the 0x Protocol settler contract"
      - name: zid
        description: "0x Protocol ZID"
      - name: tx_to
        description: "Transaction recipient address"
      - name: tx_from
        description: "Transaction sender address"
      - name: taker
        description: "Taker address"
      - name: tx_index
        description: "Transaction index in the block"
      - name: amount
        description: "Amount from the log data"
      - name: log_type
        description: "Type of log (swap if the topic matches specific signatures or contract is settler)"
      - name: data
        description: "Raw log data"
      - name: rn
        description: "Row number within transaction ordered by index"
      - name: cow_rn
        description: "Row number for CoW Protocol trades"
      - name: bundled_tx
        description: "Flag indicating if the transaction is bundled" 