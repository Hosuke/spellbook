version: 2

models:
  - name: gas_abstract_fees
    meta:
      blockchain: abstract
      sector: gas
      contributors: hosuke
    config:
      tags: ['abstract', 'gas', 'fees']
    description: >
        Gas Fees on Abstract. Note that Abstract uses a unique gas fee mechanism that includes both offchain (fixed) and onchain (variable) components,
        with a smart refund system for unused resources and overpayments.
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_month
            - block_number
            - tx_hash
      - check_seed:
          seed_file: ref('evm_gas_fees')
          filter:
            blockchain: abstract
          match_columns:
            - blockchain
            - tx_hash
          check_columns:
            - tx_fee_raw
      - dbt_utils.expression_is_true:
          expression: "tx_fee_raw >= 0"
          config:
            where: "block_time > now() - interval '7' day" 